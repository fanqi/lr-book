<?xml version="1.0" encoding="UTF-8"?>
<custom-sql>
	<sql id="com.fingence.slayer.service.persistence.MyResultFinderImpl.findResults"> 
		<![CDATA[
			SELECT
				c.itemId,
				b.portfolioId,
				a.assetId, 
				a.security_ticker, 
				a.id_isin,
				a.name, 
				a.current_price,	
				a.security_des,
				a.security_typ,
				a.security_typ2,	
				a.parent_comp_name,	
				c.purchaseQty,
				a.security_class,	
				a.country as countryId, 
				d.name as countryName, 
				a.country_of_risk as countryOfRisk,
				a.country_of_risk as countryOfRiskName,
				a.currency_,
				(c.purchasePrice * c.purchaseQty) as purchasedMarketValue,
				(a.current_price * c.purchaseQty) as currentMarketValue,
				(a.current_price * c.purchaseQty - c.purchasePrice * c.purchaseQty) as gain_loss,
				(a.current_price * c.purchaseQty - c.purchasePrice * c.purchaseQty)/(c.purchasePrice * c.purchaseQty) * 100 as gain_loss_percent
			FROM 
				fing_Asset a, 
				fing_Portfolio b, 
				fing_PortfolioItem c, 
				Country d
			WHERE 
				b.portfolioId = ?
				and a.assetId = c.assetId 
				and b.portfolioId = c.portfolioId 
				and a.country = d.countryId
		]]>
	</sql>
</custom-sql>